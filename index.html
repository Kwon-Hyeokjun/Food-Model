<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>HY-ERICA 식당 검색기</title>

  <!-- ================= CSS ================= -->
  <style>
    body {
      margin: 0;
      padding: 20px;
      font-family: 'Noto Sans KR','Pretendard',sans-serif;
      background: #f5f6fa;
      text-align: center;
    }
    h1 {
      padding: 25px 0 10px;
      margin: 0 0 20px;
      background: white;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }
    #searchInput {
      width: 240px;
      padding: 12px;
      margin-top: 20px;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-size: 15px;
    }
    #searchBtn {
      padding: 12px 18px;
      margin-left: 8px;
      border: none;
      background: #4a6cf7;
      color: white;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
    }
    select {
      padding: 10px 12px;
      margin: 10px 6px;
      font-size: 14px;
      border-radius: 8px;
      border: 1px solid #ccc;
      background: white;
    }
    #randomBtn {
      background: #6c5ce7;
      color: white;
      border: none;
      padding: 10px 16px;
      border-radius: 8px;
      cursor: pointer;
      margin-left: 10px;
    }
    #result {
      max-width: 600px;
      margin: 30px auto;
      padding: 0 20px;
      text-align: left;
    }
    .result-card {
      background: white;
      padding: 16px;
      margin-bottom: 15px;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.08);
    }
    .tag {
      display: inline-block;
      padding: 4px 10px;
      border-radius: 20px;
      font-size: 12px;
      color: white;
      margin-bottom: 8px;
    }
    .tag-분식{background:#ff7675;}
    .tag-간편식{background:#fdcb6e;}
    .tag-야식{background:#6c5ce7;}
    .tag-동남아{background:#00cec9;}
    .tag-일식{background:#0984e3;}
    .tag-중식{background:#d63031;}
    .tag-양식{background:#e17055;}
    .tag-한식{background:#2ecc71;}
    .tag-술집{background:#636e72;}
    .store-name {
      display:block;
      font-size:18px;
      font-weight:bold;
      color:#222;
      text-decoration:none;
    }
    .store-sub{font-size:14px;color:#555;margin:4px 0;}
    .store-price{font-size:14px;font-weight:bold;color:#444;}
    .fav-btn {
      float:right;
      border:none;
      background:none;
      font-size:20px;
      cursor:pointer;
    }
  </style>
</head>

<body>
<h1>HY-ERICA 식당 검색기</h1>

<input id="searchInput" placeholder="키워드 입력…" />
<button id="searchBtn">검색</button><br/>

<select id="categorySelect">
  <option value="전체">전체</option>
  <option value="분식">분식</option>
  <option value="간편식">간편식</option>
  <option value="야식">야식</option>
  <option value="동남아">동남아</option>
  <option value="일식">일식</option>
  <option value="중식">중식</option>
  <option value="양식">양식</option>
  <option value="한식">한식</option>
  <option value="술집">술집</option>
</select>

<select id="priceSelect">
  <option value="전체">전체</option>
  <option value="1만원 이하">1만원 이하</option>
  <option value="2만원 이하">2만원 이하</option>
  <option value="3만원 이하">3만원 이하</option>
</select>

<label>
  <input type="checkbox" id="favOnly"> ⭐ 즐겨찾기만 보기
</label>

<button id="randomBtn">오늘 뭐 먹지?</button>
<hr/>
<div id="result"></div>

<!-- ================= JS (DATA + LOGIC) ================= -->
<script>
/* ---------- DATA ---------- */
const STORE_DATA = [
  { category:"분식", name:"명가떡볶이", sub:"떡볶이, 김밥", price:"1만원 이하" },
  { category:"간편식", name:"이삭토스트", sub:"토스트", price:"1만원 이하" },
  { category:"일식", name:"유메", sub:"라멘", price:"1만원 이하" },
  { category:"중식", name:"북경반점", sub:"짜장면, 짬뽕", price:"1만원 이하" },
  { category:"한식", name:"산들에한상", sub:"백반", price:"1만원 이하" },
  { category:"술집", name:"역전할머니맥주", sub:"맥주", price:"2만원 이하" }
];

/* ---------- LOGIC ---------- */
const FAV_KEY = "favs";
const getFavs = () => JSON.parse(localStorage.getItem(FAV_KEY) || "[]");
const setFavs = f => localStorage.setItem(FAV_KEY, JSON.stringify(f));

const searchInput = document.getElementById("searchInput");
const categorySelect = document.getElementById("categorySelect");
const priceSelect = document.getElementById("priceSelect");
const favOnly = document.getElementById("favOnly");
const searchBtn = document.getElementById("searchBtn");
const randomBtn = document.getElementById("randomBtn");

function priceMatch(storePrice, selectedPrice){
  if(selectedPrice==="전체") return true;
  if(!storePrice.includes("이하")) return false;
  const L={"1만원 이하":1,"2만원 이하":2,"3만원 이하":3};
  return L[storePrice] <= L[selectedPrice];
}

function getFiltered(){
  const kw = searchInput.value.trim();
  const favs = getFavs();
  return STORE_DATA.filter(s =>
    (categorySelect.value==="전체" || s.category===categorySelect.value) &&
    priceMatch(s.price, priceSelect.value) &&
    (kw==="" || s.name.includes(kw) || s.sub.includes(kw)) &&
    (!favOnly.checked || favs.includes(s.name))
  );
}

function render(list){
  const box = document.getElementById("result");
  const favs = getFavs();
  if(!list.length){ box.innerHTML="<p>검색 결과 없음</p>"; return; }

  box.innerHTML = list.map(s=>{
    const star = favs.includes(s.name) ? "★" : "⭐";
    return `
      <div class="result-card">
        <span class="tag tag-${s.category}">${s.category}</span>
        <button class="fav-btn" data-name="${s.name}">${star}</button>
        <a class="store-name" target="_blank"
          href="https://map.naver.com/v5/search/${encodeURIComponent(s.name)}">${s.name}</a>
        <div class="store-sub">${s.sub}</div>
        <div class="store-price">${s.price}</div>
      </div>`;
  }).join("");

  document.querySelectorAll(".fav-btn").forEach(b=>{
    b.onclick=()=>{
      let f=getFavs();
      f=f.includes(b.dataset.name)?f.filter(v=>v!==b.dataset.name):[...f,b.dataset.name];
      setFavs(f);
      render(getFiltered());
    };
  });
}

function search(){ render(getFiltered()); }

searchBtn.onclick = search;
categorySelect.onchange = search;
priceSelect.onchange = search;
favOnly.onchange = search;

randomBtn.onclick = ()=>{
  const list = getFiltered();
  if(!list.length){ alert("조건에 맞는 식당이 없습니다!"); return; }
  render([list[Math.floor(Math.random()*list.length)]]);
};
</script>
</body>
</html>
